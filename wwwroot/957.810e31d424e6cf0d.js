"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[957],{83957:(Ie,S,s)=>{s.r(S),s.d(S,{AdminModule:()=>qe});var m=s(88692),d=s(33178),i=s(20092),q=s(7666),v=s(9638),Z=s(83331),e=s(64537),A=s(72516);let O=(()=>{class o{constructor(t,r){this.router=t,this.selectedTab=0}ngOnInit(){console.log(location.pathname),location.pathname.includes("amrUser")&&(this.selectedTab=0),location.pathname.includes("amrMeter")&&(this.selectedTab=1),location.pathname.includes("meterMapping")&&(this.selectedTab=2)}onChange(t){0==t.index&&this.router.navigate(["/admin/amrUser"]),1==t.index&&this.router.navigate(["/admin/amrMeter"]),2==t.index&&this.router.navigate(["/admin/meterMapping"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.F0),e.Y36(d.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:9,vars:2,consts:[[1,"flex","flex-col","flex-auto","min-w-0","gap-y-4"],[1,"flex","border-t","-mt-px","pt-4","sm:pt-6"],[1,"w-full","mx-auto","admin"],[1,"sm:px-2",3,"animationDuration","selectedIndex","selectedTabChange"],["label","AMR Users"],["label","AMR Meters"],["label","Meter Mapping"],[1,"flex","px-8","py-2"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-tab-group",3),e.NdJ("selectedTabChange",function(l){return r.onChange(l)}),e._UZ(4,"mat-tab",4)(5,"mat-tab",5)(6,"mat-tab",6),e.qZA()()(),e.TgZ(7,"div",7),e._UZ(8,"router-outlet"),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("animationDuration","0")("selectedIndex",r.selectedTab))},dependencies:[d.lC,A.SP,A.uX],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto&family=Roboto+Flex:opsz@8..144&display=swap";.nav-tabs[_ngcontent-%COMP%]{border-bottom:3px solid #9fa1a3;padding-bottom:1px}.link-hover[_ngcontent-%COMP%]{font-family:Open Sans;width:200px;font-size:16px;color:#fff;cursor:pointer;height:auto;text-align:center;border:none;background-size:300% 100%;border-radius:50px;margin:10px;padding:15px;text-decoration:none;transition:.4s all ease-in-out}.link-hover[_ngcontent-%COMP%]:hover{background-position:100% 0}.wizard[_ngcontent-%COMP%]{display:inline-block;margin-top:20px}.links[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer;font-family:Roboto,sans-serif;color:#566787;font-weight:500;font-size:25px}.links[_ngcontent-%COMP%]:hover{color:#3d4060;transition:.2s all ease-in-out}.container[_ngcontent-%COMP%]{padding-top:40px}.nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#19233c;background-color:none!important}.amr-edit[_ngcontent-%COMP%]{width:36px;height:36px}  .admin .mat-tab-group .mat-tab-body-content{padding:0}']}),o})();var _=s(5792),T=s(98613),C=s(61610),c=s(78208);const F=function(o){return["/admin/amrUser/edit",o,0]};let D=(()=>{class o{constructor(t,r){this.userService=t,this._router=r,this.user=this.userService.userValue,this.allowedPageSizes=_.Sx,this.onEdit=this.onEdit.bind(this)}ngOnInit(){this.user$=this.userService.user$,this.userService.getUser(this.user.Id).subscribe()}onEdit(t){t.event.preventDefault(),this._router.navigate([`/admin/amrUser/edit/${this.user.Id}/${t.row.data.Id}`])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(T.K),e.Y36(d.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:19,vars:21,consts:[[1,"flex","flex-col","relative"],[1,"absolute","left-2","top-2","z-20"],["mat-raised-button","","color","primary",1,"dnm-btn","dnm-btn-primary",3,"routerLink"],[1,"mr-1",3,"svgIcon"],[1,"flex","w-full"],[1,"flex","flex-col","bg-card","p-2"],[1,"grid-container",3,"dataSource","showBorders"],["rowRenderingMode","virtual"],[3,"pageSize"],[3,"visible","allowedPageSizes","displayMode","showPageSizeSelector","showInfo","showNavigationButtons"],["placeholder","Search...",3,"visible","width"],["dataField","ProfileName",3,"width"],["dataField","ScadaUserName",3,"width"],["dataField","SgdUrl"],["dataField","Active",3,"width"],["type","buttons"],["hint","Edit","icon","edit",3,"onClick"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e._UZ(3,"mat-icon",3),e._uU(4," Add new user "),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"dx-data-grid",6),e.ALo(8,"async"),e._UZ(9,"dxo-scrolling",7)(10,"dxo-paging",8)(11,"dxo-pager",9)(12,"dxo-search-panel",10)(13,"dxi-column",11)(14,"dxi-column",12)(15,"dxi-column",13)(16,"dxi-column",14),e.TgZ(17,"dxi-column",15),e._UZ(18,"dxi-button",16),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("routerLink",e.VKq(19,F,r.user.Id)),e.xp6(1),e.Q6J("svgIcon","feather:addUser"),e.xp6(4),e.Q6J("dataSource",e.lcZ(8,17,r.user$).AmrScadaUsers)("showBorders",!0),e.xp6(3),e.Q6J("pageSize",10),e.xp6(1),e.Q6J("visible",!0)("allowedPageSizes",r.allowedPageSizes)("displayMode","compact")("showPageSizeSelector",!0)("showInfo",!0)("showNavigationButtons",!0),e.xp6(1),e.Q6J("visible",!0)("width",200),e.xp6(1),e.Q6J("width",200),e.xp6(1),e.Q6J("width",200),e.xp6(2),e.Q6J("width",120),e.xp6(2),e.Q6J("onClick",r.onEdit))},dependencies:[d.rH,v.lW,Z.Hw,C.e,c.qvW,c.k4o,c.ilc,c.sXh,c.PXJ,c.XXE,m.Ov],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,200;8..144,400&display=swap";@import"https://fonts.googleapis.com/css2?family=Nunito:wght@500&display=swap";span[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:200px}button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:30px;height:auto;margin:5px}div.row[_ngcontent-%COMP%]{height:-moz-fit-content!important;height:fit-content!important}table[_ngcontent-%COMP%]{height:150px;vertical-align:middle}thead[_ngcontent-%COMP%]{background-color:#5ec4e1!important;font-family:Roboto Flex,sans-serif}.table-responsive[_ngcontent-%COMP%]{background-color:#fff}tr[_ngcontent-%COMP%]{transition:.2s all ease-in-out;margin:5px;color:#545454}#noHover[_ngcontent-%COMP%]{font-size:17px;color:#000}#noHover[_ngcontent-%COMP%]:hover{background-color:#5ec4e1!important}tr[_ngcontent-%COMP%]:hover{background-color:#c7dff5d9}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#c7c7c759}tr[_ngcontent-%COMP%]:nth-child(even):hover{background-color:#c7dff5d9}.customButton[_ngcontent-%COMP%]{font-family:Nunito,sans-serif;width:100%;height:auto;border-radius:50px;background-color:#dee8f7;transition:.2s all ease-in-out;border:none;color:#000;box-shadow:5px 5px 9px 1px #0000004d}.customButton[_ngcontent-%COMP%]:hover{transform:scale(1.03)}#topDetails[_ngcontent-%COMP%]{color:#565656;text-transform:uppercase}#userField[_ngcontent-%COMP%]{width:100%;background-color:#fff;height:90px;margin:10px 0;padding:10px;border:1px solid #ddd;border-radius:5px;color:#767676;box-shadow:0 6px 7px -1px #0000003b;cursor:pointer;transition:.2s all ease-in-out}#userField[_ngcontent-%COMP%]:hover{background-color:#e6e7e8}.alignItems[_ngcontent-%COMP%]{vertical-align:middle;margin:auto}#userLink[_ngcontent-%COMP%]{text-decoration:none;cursor:pointer;font-family:Roboto Flex,sans-serif;font-weight:300px;font-size:30px;color:#02002e}#userLink[_ngcontent-%COMP%]:hover{transition:.2s all ease-in-out;color:#02002eb2}#edit-link[_ngcontent-%COMP%]{font-weight:700;color:#19233c}#edit-link[_ngcontent-%COMP%]:hover{text-decoration:underline;font-weight:700;color:#566787}.imgHov[_ngcontent-%COMP%]{position:relative;width:25px;height:25px;float:left;margin-right:10px}.imgHov[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative;bottom:0;right:0;background:#8f8e8f;color:#fff;margin-bottom:5px;font-family:sans-serif;opacity:0;visibility:hidden;transition:visibility 0s,opacity .5s linear}.imgHov[_ngcontent-%COMP%]:hover   div[_ngcontent-%COMP%]{width:80px;padding:1px 5px;visibility:visible;opacity:.7}']}),o})();const z=function(){return["/admin/amrUser"]},L=function(o,n){return["/admin/amrUser/edit",o,n]};function R(o,n){if(1&o&&(e.TgZ(0,"div")(1,"div",3)(2,"div",4)(3,"h1",5),e._uU(4),e.qZA(),e.TgZ(5,"div",6)(6,"div",7)(7,"div",8)(8,"b")(9,"em"),e._uU(10,"Profile Name:"),e.qZA()()(),e.TgZ(11,"div",8),e._uU(12),e.qZA()(),e._UZ(13,"hr"),e.TgZ(14,"div",7)(15,"div",8)(16,"b")(17,"em"),e._uU(18,"Scada Username:"),e.qZA()()(),e.TgZ(19,"div",8),e._uU(20),e.qZA()(),e._UZ(21,"hr"),e.TgZ(22,"div",7)(23,"div",8)(24,"b")(25,"em"),e._uU(26,"Sgd Url:"),e.qZA()()(),e.TgZ(27,"div",8),e._uU(28),e.qZA()(),e._UZ(29,"hr"),e.TgZ(30,"div",7)(31,"div",8)(32,"b")(33,"em"),e._uU(34,"Active:"),e.qZA()()(),e.TgZ(35,"div",8),e._uU(36),e.qZA(),e._UZ(37,"hr"),e.qZA()(),e.TgZ(38,"div",9)(39,"button",10),e._UZ(40,"i",11),e._uU(41," Back "),e.qZA(),e.TgZ(42,"button",12),e._uU(43," Edit "),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(4),e.hij("User Details for User with Id: ",t.amrUser.Id,""),e.xp6(8),e.Oqu(t.amrUser.ProfileName),e.xp6(8),e.Oqu(t.amrUser.ScadaUserName),e.xp6(8),e.Oqu(t.amrUser.SgdUrl),e.xp6(8),e.Oqu(t.amrUser.Active),e.xp6(3),e.Q6J("routerLink",e.DdM(7,z)),e.xp6(3),e.Q6J("routerLink",e.WLB(8,L,t.opUser.Id,t.amrUser.Id))}}let B=(()=>{class o{constructor(t,r){this.route=t,this.usrService=r}ngOnInit(){const t=+this.route.snapshot.paramMap.get("id");this.opUser=this.usrService.userValue,this.amrUser=this.opUser.AmrScadaUsers.find(r=>r.Id==t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.gz),e.Y36(T.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:3,vars:1,consts:[[2,"margin","40px 10px"],[2,"text-align","left","margin","30px 0"],[4,"ngIf"],[1,"card","row"],[1,"info","col-md-12"],[1,"title","card-header"],[1,"card-body","description"],[1,"row"],[1,"col-md-6"],[1,"card-footer","col-md-12"],["queryParamsHandling","preserve",1,"btn","btn-outline-secondary","mr-3",2,"width","80px",3,"routerLink"],[1,"fa","fa-chevron-left"],[1,"btn","btn-outline-primary",2,"width","80px",3,"routerLink"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"section",1),e.YNc(2,R,44,11,"div",2),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",r.amrUser))},dependencies:[m.O5,d.rH],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz@8..144&display=swap";.card[_ngcontent-%COMP%]{border-radius:10px;width:100%;margin:0;max-width:100%;min-height:auto;height:auto;align-content:center;box-shadow:0 3px 5px -1px #0003,0 5px 8px #00000024,0 1px 14px #0000001f;overflow:hidden;background-size:cover}.info[_ngcontent-%COMP%]{position:relative;width:100%;height:auto;background-color:#ffffffd9;transition:transform .5s ease-out;padding:0}.info[_ngcontent-%COMP%]:before{z-index:-1;display:block;position:absolute;content:"";width:100%;height:100%;overflow:hidden;filter:blur(10px);background-size:cover;opacity:.25;transition:transform .5s ease-out}.title[_ngcontent-%COMP%]{margin:0;padding:24px;font-size:40px;line-height:1;color:#000000de}.description[_ngcontent-%COMP%]{margin:0;font-size:18px;line-height:1.5;font-family:Roboto Flex,sans-serif!important}.sideImage[_ngcontent-%COMP%]{width:100%;height:100%;border-top-left-radius:20px;border-bottom-left-radius:20px;background-position:bottom center;background-size:cover}@media only screen and (max-width: 800px){.title[_ngcontent-%COMP%]{margin:0;padding:24px;font-size:5vh;line-height:1;color:#000000de}}']}),o})();var g=s(17253);const E=function(o){return["/admin/amrMeter/edit",o,0]};let Y=(()=>{class o{constructor(t,r,a){this.meterService=t,this.userService=r,this._router=a,this.allowedPageSizes=_.Sx,this.onEdit=this.onEdit.bind(this)}ngOnInit(){this.user=this.userService.userValue,this.meters$=this.meterService.getMetersForUser(this.user.Id)}onEdit(t){t.event.preventDefault(),this._router.navigate([`/admin/amrMeter/edit/${this.user.Id}/${t.row.data.Id}`])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.kC),e.Y36(g.KD),e.Y36(d.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-amr-meter"]],decls:19,vars:21,consts:[[1,"flex","flex-col","relative"],[1,"absolute","left-2","top-2","z-20"],["mat-raised-button","","color","primary",1,"dnm-btn","dnm-btn-primary",3,"routerLink"],[1,"mr-1",3,"svgIcon"],[1,"flex","w-full"],[1,"flex","flex-col","bg-card","p-2"],[1,"grid-container",3,"dataSource","showBorders"],["rowRenderingMode","virtual"],[3,"pageSize"],[3,"visible","allowedPageSizes","displayMode","showPageSizeSelector","showInfo","showNavigationButtons"],["placeholder","Search...",3,"visible","width"],["dataField","MeterNo",3,"width"],["dataField","Description"],["dataField","Make",3,"width"],["dataField","Model",3,"width"],["type","buttons"],["hint","Edit","icon","edit",3,"onClick"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e._UZ(3,"mat-icon",3),e._uU(4," Add New Meter "),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"dx-data-grid",6),e.ALo(8,"async"),e._UZ(9,"dxo-scrolling",7)(10,"dxo-paging",8)(11,"dxo-pager",9)(12,"dxo-search-panel",10)(13,"dxi-column",11)(14,"dxi-column",12)(15,"dxi-column",13)(16,"dxi-column",14),e.TgZ(17,"dxi-column",15),e._UZ(18,"dxi-button",16),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("routerLink",e.VKq(19,E,r.user.Id)),e.xp6(1),e.Q6J("svgIcon","feather:addMeter"),e.xp6(4),e.Q6J("dataSource",e.lcZ(8,17,r.meters$))("showBorders",!0),e.xp6(3),e.Q6J("pageSize",10),e.xp6(1),e.Q6J("visible",!0)("allowedPageSizes",r.allowedPageSizes)("displayMode","compact")("showPageSizeSelector",!0)("showInfo",!0)("showNavigationButtons",!0),e.xp6(1),e.Q6J("visible",!0)("width",200),e.xp6(1),e.Q6J("width",200),e.xp6(2),e.Q6J("width",120),e.xp6(1),e.Q6J("width",120),e.xp6(2),e.Q6J("onClick",r.onEdit))},dependencies:[d.rH,v.lW,Z.Hw,C.e,c.qvW,c.k4o,c.ilc,c.sXh,c.PXJ,c.XXE,m.Ov],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,200;8..144,400&display=swap";@import"https://fonts.googleapis.com/css2?family=Nunito:wght@500&display=swap";span[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:200px}button[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:30px;height:auto;margin:5px}div.row[_ngcontent-%COMP%]{height:-moz-fit-content!important;height:fit-content!important}.hr_devider[_ngcontent-%COMP%]{border:2px solid #0a85b6;width:50%;border-radius:10px;margin:20px auto;align-self:center}#meterField[_ngcontent-%COMP%]{width:100%;background-color:#fff;height:90px;margin:0;padding:5px;border:1px solid #ddd;border-radius:5px;color:#767676;box-shadow:0 6px 7px -1px #0000003b;cursor:pointer;transition:.2s all ease-in-out}#meterField[_ngcontent-%COMP%]:hover{background-color:#e6e7e8}#edit-link[_ngcontent-%COMP%]{font-weight:700;color:#19233c}#edit-link[_ngcontent-%COMP%]:hover{text-decoration:underline;font-weight:700;color:#566787}.customButton[_ngcontent-%COMP%]{font-family:Nunito,sans-serif;width:100%;height:auto;border-radius:50px;background-color:#dee8f7;transition:.2s all ease-in-out;border:none;color:#000;box-shadow:5px 5px 9px 1px #0000004d}.customButton[_ngcontent-%COMP%]:hover{transform:scale(1.03)}.imgHov[_ngcontent-%COMP%]{position:relative;width:25px;height:25px;float:left;margin-right:10px}.imgHov[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:relative;bottom:0;right:0;background:#8f8e8f;color:#fff;margin-bottom:5px;font-family:sans-serif;opacity:0;visibility:hidden;transition:visibility 0s,opacity .5s linear}.imgHov[_ngcontent-%COMP%]:hover   div[_ngcontent-%COMP%]{width:80px;padding:1px 5px;visibility:visible;opacity:.7}']}),o})();var f=s(34553);const I={title:"Are you sure?",message:"",icon:{show:!0,name:"heroicons_outline:exclamation",color:"warn"},actions:{cancel:{show:!0,label:"Cancel",color:"warn"},confirm:{show:!0,color:"primary",label:"Ok"}},dismissible:!0};var V=s(36559),x=s(54536);function H(o){return n=>n.value&&n.value!=o?{check:!0}:null}var P=s(38023),J=s(16043),h=s(88659),M=s(39665);let G=(()=>{class o{constructor(){this.fields=[]}validate(t){return function X(o,n){return t=>{const r=t.controls[o],a=t.controls[n];if(!r||!a||!r.value||!a.value||a.errors&&!a.errors.matchValueError)return null;a.setErrors(r.value!=a.value?{matchValueError:!0}:null)}}(this.fields[0],this.fields[1])(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","passwordMatchValidator",""]],inputs:{fields:["passwordMatchValidator","fields"]},features:[e._Bn([{provide:i.Cf,useExisting:o,multi:!0}])]}),o})();function K(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Current Password is required "),e.qZA())}function W(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Current Password must be at least three characters. "),e.qZA())}function j(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Supplied password is incorrect. "),e.qZA())}function $(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," New Password is required "),e.qZA())}function ee(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," New Password must be at least three characters. "),e.qZA())}function te(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Confirm Password is required. "),e.qZA())}function re(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Passwords do not match. "),e.qZA())}const oe=function(){return["newPwd","confPwd"]};let ie=(()=>{class o{constructor(t,r,a,l){this.matDialogRef=t,this._formBuilder=r,this._ufUtils=l,this.submitted=!1,this._unsubscribeAll=new P.x,this.data=a}ngOnInit(){console.log("old password",this.data.currentPassword),this.form=this._formBuilder.group({currPwd:[null,[i.kI.required,i.kI.minLength(3),H(this.data.currentPassword)]],newPwd:["",[i.kI.required,i.kI.minLength(3)]],confPwd:["",i.kI.required]}),this.data.detail&&this.form.patchValue(this.data.detail)}close(){this.matDialogRef.close()}submit(){this.submitted=!0,this.form.valid&&this._ufUtils.fuseConfirmDialog(I,"","Are you sure you need to change password?").afterClosed().subscribe(r=>{"confirmed"==r?this.matDialogRef.close(this.form.value):this.matDialogRef.close()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.so),e.Y36(i.qu),e.Y36(x.WI),e.Y36(J.q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-amr-user-password"]],decls:36,vars:22,consts:[[1,"flex","flex-col","flex-auto","min-w-120","max-w-120","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-12","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium","text-white"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-0","w-full","p-4","sm:p-6","gap-y-2",3,"formGroup","passwordMatchValidator"],[1,"row","grid","grid-cols-1","gap-2"],[1,"col-span-1"],[1,"fuse-mat-dense","w-full",3,"floatLabel"],[1,"form-label"],["matInput","","type","password",3,"formControlName","placeholder"],[4,"ngIf"],[1,"row","flex","gap-y-2","justify-end","flex"],["mat-stroked-button","","color","primary","type","button",1,"w-30","mr-4",3,"click"],["mat-raised-button","","color","primary","type","button",1,"dnm-btn","dnm-btn-primary","w-30",3,"disabled","click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Change Password"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return r.matDialogRef.close()}),e._UZ(5,"mat-icon",4),e.qZA()(),e.TgZ(6,"form",5)(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label",9),e._uU(11," Password "),e.qZA(),e._UZ(12,"input",10),e.YNc(13,K,2,0,"mat-error",11),e.YNc(14,W,2,0,"mat-error",11),e.YNc(15,j,2,0,"mat-error",11),e.qZA()()(),e.TgZ(16,"div",7)(17,"mat-form-field",8)(18,"mat-label",9),e._uU(19," New Password "),e.qZA(),e._UZ(20,"input",10),e.YNc(21,$,2,0,"mat-error",11),e.YNc(22,ee,2,0,"mat-error",11),e.qZA()(),e.TgZ(23,"div",7)(24,"mat-form-field",8)(25,"mat-label",9),e._uU(26," Confirm Password "),e.qZA(),e._UZ(27,"input",10),e.YNc(28,te,2,0,"mat-error",11),e.YNc(29,re,2,0,"mat-error",11),e.qZA()(),e.TgZ(30,"div",12)(31,"div",7)(32,"button",13),e.NdJ("click",function(){return r.close()}),e._uU(33,"Cancel"),e.qZA(),e.TgZ(34,"button",14),e.NdJ("click",function(){return r.submit()}),e._uU(35,"Change"),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("tabIndex",-1),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(1),e.Q6J("formGroup",r.form)("passwordMatchValidator",e.DdM(21,oe)),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","currPwd")("placeholder","Current Password"),e.xp6(1),e.Q6J("ngIf",r.form.get("currPwd").getError("required")),e.xp6(1),e.Q6J("ngIf",null==r.form.get("currPwd").errors?null:r.form.get("currPwd").errors.minlength),e.xp6(1),e.Q6J("ngIf",null==r.form.get("currPwd").errors?null:r.form.get("currPwd").errors.check),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","newPwd")("placeholder","New Password (required)"),e.xp6(1),e.Q6J("ngIf",r.form.get("newPwd").getError("required")),e.xp6(1),e.Q6J("ngIf",null==r.form.get("newPwd").errors?null:r.form.get("newPwd").errors.minlength),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","confPwd")("placeholder","Confirm Password (required)"),e.xp6(1),e.Q6J("ngIf",null==r.form.get("confPwd").errors?null:r.form.get("confPwd").errors.required),e.xp6(1),e.Q6J("ngIf",r.form.get("confPwd").getError("matchValueError")),e.xp6(5),e.Q6J("disabled",!r.form.valid))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,m.O5,i.sg,i.u,v.lW,Z.Hw,h.TO,h.KE,h.hX,M.Nt,G]}),o})(),ne=(()=>{class o{constructor(){this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(r=>r.id!==t)}open(t){this.modals.find(a=>a.id===t).open()}close(t){this.modals.find(a=>a.id===t).close()}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ae=s(66292);let se=(()=>{class o{constructor(t){this.data=t}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:13,vars:7,consts:[[1,"card"],[1,"card-header"],["mat-dialog-title",""],["mat-icon-button","",3,"mat-dialog-close"],["src","/assets/images/icons/notify_Close_1.svg",2,"width","40px"],["mat-dialog-content","",1,"card-body"],["mat-dialog-actions","",1,"card-footer","border-t","flex","gap-x-2"],[1,"dnm-btn","dnm-btn-cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",1,"dnm-btn","dnm-btn-primary",3,"mat-dialog-close"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e._UZ(5,"img",4),e.qZA()(),e.TgZ(6,"div",5),e._uU(7),e.qZA(),e.TgZ(8,"div",6)(9,"button",7),e._uU(10),e.qZA(),e.TgZ(11,"button",8),e._uU(12),e.qZA()()()),2&t&&(e.xp6(3),e.Oqu(null==r.data?null:r.data.Title),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.Oqu(null==r.data?null:r.data.Message),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Oqu(null==r.data?null:r.data.CancelText),e.xp6(1),e.Q6J("mat-dialog-close",!0),e.xp6(1),e.Oqu(null==r.data?null:r.data.ConfirmText))},dependencies:[x.ZT,x.uh,x.xY,x.H8,v.lW],styles:[".card[_ngcontent-%COMP%]{border-radius:10px;margin-top:0}.card-body[_ngcontent-%COMP%]{padding:24px!important}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}button[_ngcontent-%COMP%]{width:80px;min-width:80px}"]}),o})(),k=(()=>{class o{constructor(t){this.dialog=t}confirmDialog(t){return this.dialog.open(se,{data:t,width:"400px",disableClose:!0}).afterClosed()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(x.uw))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function le(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.deleteAmrUser())}),e._uU(1,"Delete"),e.qZA()}}function de(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.openModal("changePwd"))}),e._uU(1,"Change Password"),e.qZA()}}let ce=(()=>{class o{constructor(t,r,a,l,u,b,U,p,w){this.route=t,this.usrService=r,this.router=a,this.modalService=l,this.fb=u,this.snackBarService=b,this.dialogService=U,this._matDialog=p,this._ufUtils=w,this.pageTitle="Edit Amr Scada User"}getAmrScadaUser(t){this.usrService.getAmrScadaUser(t).subscribe({next:r=>{this.onAmrScadaUserRetrieved(r),this.initForm()},error:r=>this.errMessage=r})}initForm(){console.log(this.amrUser),this.amrUser&&this.form.patchValue(this.amrUser)}onAmrScadaUserRetrieved(t){var r=this;return(0,f.Z)(function*(){r.amrUser=t,r.pageTitle=r.amrUser?0===r.amrUser.Id?"Add New User":`Edit User: ${r.amrUser.ScadaUserName}`:"User not found"})()}ngOnInit(){this.form=this.fb.group({Id:[0],ProfileName:[null,[i.kI.required,i.kI.minLength(3)]],ScadaUserName:[null,[i.kI.required,i.kI.minLength(3)]],SgdUrl:[null,[i.kI.required,i.kI.minLength(3)]],ScadaPassword:[null,[i.kI.required,i.kI.minLength(3)]]}),this.route.paramMap.subscribe(t=>{this.opUsrId=+t.get("opId");const r=+t.get("asuId");this.getAmrScadaUser(r)})}openModal(t){var r=this;return(0,f.Z)(function*(){var a=(yield r.usrService.decryptWrapper(r.amrUser.ScadaPassword)).toString();r._matDialog.open(ie,{autoFocus:!1,data:{currentPassword:a}}).afterClosed().subscribe(function(){var l=(0,f.Z)(function*(u){if(u){r.amrUser.ScadaPassword=u.newPwd;try{r.amrUser=yield(0,V.n)(r.usrService.changePwd(r.amrUser)),r.getAmrScadaUser(r.amrUser.Id),r.snackBarService.passDataToSnackComponent({msg:"Password Changed",style:"success"})}catch(b){r.errMessage=b.message}}});return function(u){return l.apply(this,arguments)}}())})()}closeModalNoMsg(t){this.errMessageModal="",this.formChangePwd.reset(),this.modalService.close(t)}closeModal(t,r,a){this.errMessageModal="",this.formChangePwd.reset(),this.modalService.close(t),this.snackBarService.passDataToSnackComponent(r||a?{msg:r,style:a}:{msg:"Operation Cancelled",style:a})}saveAmrUser(){var t=this;return(0,f.Z)(function*(){if(t.form.valid){const r={...t.amrUser,...t.form.value};r.ScadaPassword=(yield t.usrService.encryptWrapper(r.ScadaPassword)).toString(),t._ufUtils.fuseConfirmDialog(I,"","Are you sure you want to save?").afterClosed().subscribe(l=>{"confirmed"==l&&t.usrService.updateAmrScadaUser(t.opUsrId,r).subscribe({next:()=>{t.onSaveComplete()},error:u=>t.errMessage=u})})}})()}deleteAmrUser(){this.dialogService.confirmDialog(_.Cw.deleteDialog).subscribe({next:r=>{r&&this.usrService.deleteAmrScadaUser(this.opUsrId,this.amrUser).subscribe({next:()=>{this.getAmrScadaUser(this.amrUser.Id),this.router.navigate(["/admin"]),this.snackBarService.passDataToSnackComponent({msg:"User Removed",style:"success"})},error:a=>this.errMessage=a})},error:r=>this.errMessage=r})}onSaveComplete(){this.form.reset(),this.getAmrScadaUser(this.amrUser.Id),this.router.navigate(["/admin"])}toggleFieldTextType(){this.fieldTextType=!this.fieldTextType}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.gz),e.Y36(T.K),e.Y36(d.F0),e.Y36(ne),e.Y36(i.qu),e.Y36(ae.c),e.Y36(k),e.Y36(x.uw),e.Y36(J.q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:32,vars:17,consts:[[1,"flex","flex-col","bg-card","py-6","px-4","w-full",3,"formGroup"],[1,"text-lg","font-semibold","mb-2"],[1,"row","grid","grid-cols-2","gap-x-4","gap-y-2","w-full"],[1,"col-span-1"],[1,"fuse-mat-dense","w-full",3,"floatLabel"],[1,"form-label"],["matInput","",3,"formControlName","placeholder"],["matInput","",3,"formControlName","placeholder","readonly"],[1,"pt-3","px-4","border-t","border-gray-300","text-gray-600","flex","justify-end","gap-x-4"],["class","dnm-btn dnm-btn-delete","type","button",3,"click",4,"ngIf"],["routerLink","/admin","type","button",1,"dnm-btn","dnm-btn-cancel"],["mat-raised-button","","color","primary","type","button",1,"dnm-btn","dnm-btn-primary",3,"click"],["mat-raised-button","","color","primary","class","text-white",3,"click",4,"ngIf"],["type","button",1,"dnm-btn","dnm-btn-delete",3,"click"],["mat-raised-button","","color","primary",1,"text-white",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0)(1,"h3",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),e._uU(7,"Profile Name"),e.qZA(),e._UZ(8,"input",6),e.qZA()(),e.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label",5),e._uU(12,"Scada User Name"),e.qZA(),e._UZ(13,"input",6),e.qZA()()(),e.TgZ(14,"div",2)(15,"div",3)(16,"mat-form-field",4)(17,"mat-label",5),e._uU(18,"SGD Url"),e.qZA(),e._UZ(19,"input",6),e.qZA()(),e.TgZ(20,"div",3)(21,"mat-form-field",4)(22,"mat-label",5),e._uU(23,"Password"),e.qZA(),e._UZ(24,"input",7),e.qZA()()(),e.TgZ(25,"div",8),e.YNc(26,le,2,0,"button",9),e.TgZ(27,"button",10),e._uU(28,"Cancel"),e.qZA(),e.TgZ(29,"button",11),e.NdJ("click",function(){return r.saveAmrUser()}),e._uU(30,"Save"),e.qZA(),e.YNc(31,de,2,0,"button",12),e.qZA()()),2&t&&(e.Q6J("formGroup",r.form),e.xp6(2),e.Oqu(r.pageTitle),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","ProfileName")("placeholder","Profile Name (required)"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","ScadaUserName")("placeholder","User Name (required)"),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","SgdUrl")("placeholder","SGD Url (required)"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","ScadaPassword")("placeholder","Password (required)")("readonly",r.amrUser&&r.amrUser.Id>0),e.xp6(2),e.Q6J("ngIf",r.amrUser&&r.amrUser.Id>0),e.xp6(5),e.Q6J("ngIf",r.amrUser&&r.amrUser.Id>0))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,m.O5,d.rH,i.sg,i.u,v.lW,h.KE,h.hX,M.Nt],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,200;8..144,400&display=swap";.card[_ngcontent-%COMP%]{margin:40px 10px;box-shadow:10px 10px 33px -6px #a1a1a1;border-radius:10px}#title[_ngcontent-%COMP%]{font-family:Roboto Flex,sans-serif;font-weight:800;font-size:1.5em;color:#19233c;margin:0}.card-footer[_ngcontent-%COMP%]{margin:0}']}),o})();var me=s(44063);const ue=function(){return["/admin/amrMeter"]},pe=function(o,n){return["/admin/amrMeter/edit",o,n]};function ge(o,n){if(1&o&&(e.TgZ(0,"div")(1,"div",3)(2,"div",4)(3,"h1",5),e._uU(4),e.qZA(),e.TgZ(5,"div",6)(6,"div",7)(7,"div",8)(8,"b")(9,"em"),e._uU(10,"Description:"),e.qZA()()(),e.TgZ(11,"div",8),e._uU(12),e.qZA()(),e._UZ(13,"hr"),e.TgZ(14,"div",7)(15,"div",8)(16,"b")(17,"em"),e._uU(18,"Building:"),e.qZA()()(),e.TgZ(19,"div",8),e._uU(20),e.qZA()(),e._UZ(21,"hr"),e.TgZ(22,"div",7)(23,"div",8)(24,"b")(25,"em"),e._uU(26,"Make:"),e.qZA()()(),e.TgZ(27,"div",8),e._uU(28),e.qZA()(),e._UZ(29,"hr"),e.TgZ(30,"div",7)(31,"div",8)(32,"b")(33,"em"),e._uU(34,"Model:"),e.qZA()()(),e.TgZ(35,"div",8),e._uU(36),e.qZA()(),e._UZ(37,"hr"),e.TgZ(38,"div",7)(39,"div",8)(40,"b")(41,"em"),e._uU(42,"Phase:"),e.qZA()()(),e.TgZ(43,"div",8),e._uU(44),e.qZA()(),e._UZ(45,"hr"),e.TgZ(46,"div",7)(47,"div",8)(48,"b")(49,"em"),e._uU(50,"CB Size:"),e.qZA()()(),e.TgZ(51,"div",8),e._uU(52),e.qZA()(),e._UZ(53,"hr"),e.TgZ(54,"div",7)(55,"div",8)(56,"b")(57,"em"),e._uU(58,"CT Size Primary:"),e.qZA()()(),e.TgZ(59,"div",8),e._uU(60),e.qZA()(),e._UZ(61,"hr"),e.TgZ(62,"div",7)(63,"div",8)(64,"b")(65,"em"),e._uU(66,"CT Size Secondary:"),e.qZA()()(),e.TgZ(67,"div",8),e._uU(68),e.qZA()(),e._UZ(69,"hr"),e.TgZ(70,"div",7)(71,"div",8)(72,"b")(73,"em"),e._uU(74,"Programmed Factor:"),e.qZA()()(),e.TgZ(75,"div",8),e._uU(76),e.qZA()(),e._UZ(77,"hr"),e.TgZ(78,"div",7)(79,"div",8)(80,"b")(81,"em"),e._uU(82,"Displayed Digits:"),e.qZA()()(),e.TgZ(83,"div",8),e._uU(84),e.qZA()(),e._UZ(85,"hr"),e.TgZ(86,"div",7)(87,"div",8)(88,"b")(89,"em"),e._uU(90,"Utility:"),e.qZA()()(),e.TgZ(91,"div",8),e._uU(92),e.qZA()(),e._UZ(93,"hr"),e.TgZ(94,"div",7)(95,"div",8)(96,"b")(97,"em"),e._uU(98,"Scada Comms Id:"),e.qZA()()(),e.TgZ(99,"div",8),e._uU(100),e.qZA()(),e._UZ(101,"hr"),e.TgZ(102,"div",7)(103,"div",8)(104,"b")(105,"em"),e._uU(106,"Scada Serial No.:"),e.qZA()()(),e.TgZ(107,"div",8),e._uU(108),e.qZA()()(),e.TgZ(109,"div",9)(110,"button",10),e._UZ(111,"i",11),e._uU(112," Back "),e.qZA(),e.TgZ(113,"button",12),e._uU(114," Edit "),e.qZA()()()()()),2&o){const t=n.ngIf;e.xp6(4),e.hij("Meter Details for Meter: ",t.MeterNo,""),e.xp6(8),e.Oqu(t.Description),e.xp6(8),e.Oqu(t.BuildingName),e.xp6(8),e.Oqu(t.Make),e.xp6(8),e.Oqu(t.Model),e.xp6(8),e.Oqu(t.Phase),e.xp6(8),e.Oqu(t.CbSize),e.xp6(8),e.Oqu(t.CtSizePrim),e.xp6(8),e.Oqu(t.CtSizeSec),e.xp6(8),e.Oqu(t.ProgFact),e.xp6(8),e.Oqu(t.Digits),e.xp6(8),e.Oqu(t.Utility),e.xp6(8),e.Oqu(t.CommsId),e.xp6(8),e.Oqu(t.MeterSerial),e.xp6(2),e.Q6J("routerLink",e.DdM(16,ue)),e.xp6(3),e.Q6J("routerLink",e.WLB(17,pe,t.UserId,t.Id))}}let fe=(()=>{class o{constructor(t,r){this.route=t,this.meterService=r}ngOnInit(){const t=+this.route.snapshot.paramMap.get("id");this.meter$=this.meterService.getMeter(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.gz),e.Y36(me.k))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:4,vars:3,consts:[[2,"margin","40px 10px"],[2,"text-align","left","margin","30px 0"],[4,"ngIf"],[1,"card","row"],[1,"info","col-md-12"],[1,"title","card-header"],[1,"card-body","description"],[1,"row"],[1,"col-md-6"],[1,"card-footer","col-md-12"],["queryParamsHandling","preserve",1,"btn","btn-outline-secondary","mr-3",2,"width","80px",3,"routerLink"],[1,"fa","fa-chevron-left"],[1,"btn","btn-outline-primary",2,"width","80px",3,"routerLink"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"section",1),e.YNc(2,ge,115,20,"div",2),e.ALo(3,"async"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,r.meter$)))},dependencies:[m.O5,d.rH,m.Ov],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz@8..144&display=swap";.card[_ngcontent-%COMP%]{border-radius:10px;width:100%;margin:0;max-width:100%;min-height:auto;height:auto;align-content:center;box-shadow:0 3px 5px -1px #0003,0 5px 8px #00000024,0 1px 14px #0000001f;overflow:hidden;background-size:cover}.info[_ngcontent-%COMP%]{position:relative;width:100%;height:auto;background-color:#ffffffd9;transition:transform .5s ease-out;padding:0}.info[_ngcontent-%COMP%]:before{z-index:-1;display:block;position:absolute;content:"";width:100%;height:100%;overflow:hidden;filter:blur(10px);background-size:cover;opacity:.25;transition:transform .5s ease-out}.title[_ngcontent-%COMP%]{margin:0;padding:24px;font-size:40px;line-height:1;color:#000000de}.description[_ngcontent-%COMP%]{margin:0;font-size:18px;line-height:1.5;font-family:Roboto Flex,sans-serif!important}.sideImage[_ngcontent-%COMP%]{width:100%;height:100%;border-top-left-radius:20px;border-bottom-left-radius:20px;background-position:bottom center;background-size:cover}@media only screen and (max-width: 800px){.title[_ngcontent-%COMP%]{margin:0;padding:24px;font-size:5vh;line-height:1;color:#000000de}}']}),o})();var Q=s(85806),y=s(11208);function he(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.deleteAmrMeter())}),e._uU(1,"Delete"),e.qZA()}}let ve=(()=>{class o{constructor(t,r,a,l,u,b,U,p){this.route=t,this.router=r,this.meterService=a,this.sbService=l,this.bldService=u,this.usrService=b,this.dialogService=U,this._formBuilder=p,this.loading=!0,this.pageTitle="Edit Amr Meter",this.phaseItems=[{Label:"Single",Id:1},{Label:"Dual",Id:2},{Label:"Three",Id:3}]}getAmrMeter(t){this.meterService.getMeter(t).subscribe({next:r=>{this.onAmrMeterRetrieved(r),this.getUtilities(),this.getBuildings(),this.initForm()},error:r=>this.errMessage=r})}getUtilities(){this.meterService.getUtilties().subscribe({next:t=>{this.onUtilitiesRetrieved(t)},error:t=>this.errMessage=t.error})}getBuildings(){this.bldService.getBuildingsForUser(this.usrService.userValue.UmfaId).subscribe({next:r=>{this.onBuildingsRetrieved(r)},error:r=>this.errMessage=r,complete:()=>this.loading=!1})}onUtilitiesRetrieved(t){var r=this;return(0,f.Z)(function*(){r.utils=t,0==r.amrMeter.Id?r.changeUtil(r.utils[0].Id):r.makes=r.utils.find(a=>a.Id==r.amrMeter.UtilityId).MakeModels})()}onBuildingsRetrieved(t){var r=this;return(0,f.Z)(function*(){r.buildings=t,0==r.amrMeter.Id&&(r.amrMeter.UmfaId=r.buildings[0].BuildingId)})()}onAmrMeterRetrieved(t){var r=this;return(0,f.Z)(function*(){r.amrMeter=t,r.amrMeter?0===r.amrMeter.Id?(r.pageTitle="Add New Meter",r.amrMeter.UserId=r.opUsrId):r.pageTitle=`Edit Meter: ${r.amrMeter.MeterNo}`:r.pageTitle="User not found"})()}ngOnInit(){this.form=this._formBuilder.group({Id:[0],MeterNo:[null,[i.kI.required,i.kI.minLength(3)]],Description:["",[i.kI.required,i.kI.minLength(3)]],UmfaId:[null,[i.kI.required]],UtilityId:[null,[i.kI.required]],MakeModelId:[null,[i.kI.required]],Make:["",[i.kI.required]],Model:["",[i.kI.required]],Phase:[null,[i.kI.required]],CbSize:[null,[i.kI.required,i.kI.min(5)]],CtSizePrim:[null,[i.kI.required,i.kI.min(5)]],CtSizeSec:[null,[i.kI.required]],ProgFact:[null,[i.kI.required]],Digits:[null,[i.kI.required]],CommsId:[null,[i.kI.required]],MeterSerial:[null,[i.kI.required]]}),this.route.paramMap.subscribe(t=>{this.opUsrId=+t.get("opId");const r=+t.get("meterId");this.getAmrMeter(r)})}initForm(){console.log(this.amrMeter),this.amrMeter&&this.form.patchValue(this.amrMeter)}selectUtil(t){this.changeUtil(t)}makeModelChange(t){this.changeMakeModel(t)}changeMakeModel(t){var r=this.makes.find(a=>a.Id==t);this.amrMeter.MakeModelId=r.Id,this.amrMeter.Make=r.Make,this.amrMeter.Model=r.Model,this.form.get("Make").setValue(r.Make),this.form.get("Model").setValue(r.Model)}changeUtil(t){var r=this.utils.find(a=>a.Id==t);this.makes=r.MakeModels,this.amrMeter.UtilityId=r.Id,this.amrMeter.Utility=r.Name,this.changeMakeModel(this.makes[0].Id)}saveAmrMeter(){var t=this;return(0,f.Z)(function*(){if(t.form.valid){t.updMeter=new Q.WK,t.updMeter.UserId=t.opUsrId;let u=t.form.value,b=t.utils.find(p=>p.Id==t.form.get("UtilityId").value).Name;var a=t.buildings.find(p=>p.BuildingId==t.form.get("UmfaId").value);t.updMeter.Meter={...u,Utility:b,BuildingName:a.Name},t.dialogService.confirmDialog(_.Cw.updateDialog).subscribe({next:p=>{p?t.meterService.updateMeter(t.updMeter).subscribe({next:w=>{t.amrMeter=w,t.router.navigate(["admin/amrMeter"]),t.sbService.passDataToSnackComponent({msg:"Meter saved Successfully",style:"success"})},error:w=>t.errMessage=w}):t.sbService.passDataToSnackComponent({msg:"Meter Not Changed",style:"cancel"})},error:p=>t.errMessage=p})}})()}deleteAmrMeter(){var t=this;return(0,f.Z)(function*(){t.updMeter=new Q.WK,t.updMeter.UserId=t.opUsrId,t.updMeter.Meter=t.amrMeter,t.updMeter.Meter.Active=!1,t.dialogService.confirmDialog(_.Cw.deleteDialog).subscribe({next:a=>{a?t.meterService.updateMeter(t.updMeter).subscribe({next:l=>{t.amrMeter=l,t.router.navigate(["admin/amrMeter"]),t.sbService.passDataToSnackComponent({msg:"Meter Removed Successfully",style:"success"})},error:l=>t.errMessage=l}):t.sbService.passDataToSnackComponent({msg:"Meter Not Removed",style:"cancel"})},error:a=>t.errMessage=a})})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.gz),e.Y36(d.F0),e.Y36(g.kC),e.Y36(g.cw),e.Y36(g.Fl),e.Y36(g.KD),e.Y36(k),e.Y36(i.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:82,vars:46,consts:[[1,"flex","flex-col","bg-card","py-6","px-4","w-full",3,"formGroup"],[1,"row","grid","grid-cols-3","gap-x-4","gap-y-2","w-full"],[1,"col-span-1"],[1,"fuse-mat-dense","w-full",3,"floatLabel"],[1,"form-label"],["matInput","",3,"formControlName","placeholder"],[1,"col-span-2"],[1,"row","grid","grid-cols-5","gap-x-4","gap-y-2","w-full"],["bindLabel","Name","bindValue","BuildingId",3,"items","placeholder","formControlName","searchable","clearable"],["bindLabel","Name","bindValue","Id",3,"items","placeholder","formControlName","searchable","clearable","change"],["bindLabel","Description","bindValue","Id",3,"items","placeholder","formControlName","searchable","clearable","change"],["matInput","",3,"formControlName"],[1,"row","grid","grid-cols-4","gap-x-4","gap-y-2","w-full"],["bindLabel","Label","bindValue","Id",3,"items","placeholder","formControlName","searchable","clearable"],["matInput","","type","number","placeholder","Circuit Breaker Size",3,"formControlName"],["matInput","","type","number","placeholder","CT Primary",3,"formControlName"],["matInput","","type","number","placeholder","CT Secondary",3,"formControlName"],["matInput","","type","number","placeholder","Programmed Factor",3,"formControlName"],["matInput","","type","number","placeholder","Number of digits on display",3,"formControlName"],["type","number",1,"fuse-mat-dense","w-full",3,"floatLabel"],["matInput","","placeholder","Scada Comms Id",3,"formControlName"],["matInput","","placeholder","Scada Serial Number",3,"formControlName"],[1,"pt-3","px-4","border-t","border-gray-300","text-gray-600","flex","justify-end","gap-x-4"],["class","dnm-btn dnm-btn-delete","type","button",3,"click",4,"ngIf"],["routerLink","/admin/amrMeter","type","button",1,"dnm-btn","dnm-btn-cancel"],["mat-raised-button","","color","primary",1,"dnm-btn","dnm-btn-primary",3,"click"],["type","button",1,"dnm-btn","dnm-btn-delete",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-label",4),e._uU(5,"Meter No"),e.qZA(),e._UZ(6,"input",5),e.qZA()(),e.TgZ(7,"div",6)(8,"mat-form-field",3)(9,"mat-label",4),e._uU(10,"Description"),e.qZA(),e._UZ(11,"input",5),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",2)(14,"mat-label",4),e._uU(15," Building "),e.qZA(),e._UZ(16,"ng-select",8),e.qZA(),e.TgZ(17,"div",2)(18,"mat-label",4),e._uU(19," Utility "),e.qZA(),e.TgZ(20,"ng-select",9),e.NdJ("change",function(l){return r.selectUtil(l.Id)}),e.qZA()(),e.TgZ(21,"div",2)(22,"mat-label",4),e._uU(23," Meter Type "),e.qZA(),e.TgZ(24,"ng-select",10),e.NdJ("change",function(l){return r.makeModelChange(l.Id)}),e.qZA()(),e.TgZ(25,"div",2)(26,"mat-form-field",3)(27,"mat-label",4),e._uU(28,"Make"),e.qZA(),e._UZ(29,"input",11),e.qZA()(),e.TgZ(30,"div",2)(31,"mat-form-field",3)(32,"mat-label",4),e._uU(33,"Model"),e.qZA(),e._UZ(34,"input",11),e.qZA()()(),e.TgZ(35,"div",12)(36,"div",2)(37,"mat-label",4),e._uU(38," Phase "),e.qZA(),e._UZ(39,"ng-select",13),e.qZA(),e.TgZ(40,"div",2)(41,"mat-form-field",3)(42,"mat-label",4),e._uU(43,"CB Size"),e.qZA(),e._UZ(44,"input",14),e.qZA()(),e.TgZ(45,"div",2)(46,"mat-form-field",3)(47,"mat-label",4),e._uU(48,"CT Primary"),e.qZA(),e._UZ(49,"input",15),e.qZA()(),e.TgZ(50,"div",2)(51,"mat-form-field",3)(52,"mat-label",4),e._uU(53,"CT Secondary"),e.qZA(),e._UZ(54,"input",16),e.qZA()()(),e.TgZ(55,"div",12)(56,"div",2)(57,"mat-form-field",3)(58,"mat-label",4),e._uU(59,"Programmed Factor"),e.qZA(),e._UZ(60,"input",17),e.qZA()(),e.TgZ(61,"div",2)(62,"mat-form-field",3)(63,"mat-label",4),e._uU(64,"Number of Digits"),e.qZA(),e._UZ(65,"input",18),e.qZA()(),e.TgZ(66,"div",2)(67,"mat-form-field",19)(68,"mat-label",4),e._uU(69,"Scada Comms Id"),e.qZA(),e._UZ(70,"input",20),e.qZA()(),e.TgZ(71,"div",2)(72,"mat-form-field",3)(73,"mat-label",4),e._uU(74,"Scada Serial No"),e.qZA(),e._UZ(75,"input",21),e.qZA()()(),e.TgZ(76,"div",22),e.YNc(77,he,2,0,"button",23),e.TgZ(78,"button",24),e._uU(79,"Cancel"),e.qZA(),e.TgZ(80,"button",25),e.NdJ("click",function(){return r.saveAmrMeter()}),e._uU(81,"Save"),e.qZA()()()),2&t&&(e.Q6J("formGroup",r.form),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","MeterNo")("placeholder","Meter No"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","Description")("placeholder","Description"),e.xp6(5),e.Q6J("items",r.buildings)("placeholder","Select Building")("formControlName","UmfaId")("searchable",!1)("clearable",!1),e.xp6(4),e.Q6J("items",r.utils)("placeholder","Select Utility")("formControlName","UtilityId")("searchable",!1)("clearable",!1),e.xp6(4),e.Q6J("items",r.makes)("placeholder","Select Make/Model")("formControlName","MakeModelId")("searchable",!1)("clearable",!1),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","Make"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","Model"),e.xp6(5),e.Q6J("items",r.phaseItems)("placeholder","Select Phase")("formControlName","Phase")("searchable",!1)("clearable",!1),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","CbSize"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","CtSizePrim"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","CtSizeSec"),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","ProgFact"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","Digits"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","CommsId"),e.xp6(2),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","MeterSerial"),e.xp6(2),e.Q6J("ngIf",r.amrMeter&&r.amrMeter.Id>0))},dependencies:[i._Y,i.Fj,i.wV,i.JJ,i.JL,m.O5,d.rH,i.sg,i.u,v.lW,h.KE,h.hX,M.Nt,y.w9],styles:["button[_ngcontent-%COMP%]{min-width:120px}"]}),o})();var xe=s(66279),be=s(13528);const N=function(){return[]};function Ze(o,n){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"mat-icon"),e._uU(6,"developer_board"),e.qZA(),e._uU(7," UMFA Meters"),e.qZA(),e.TgZ(8,"dx-data-grid",10),e.NdJ("onRowClick",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.selectUmfaMeter(a))}),e._UZ(9,"dxo-scrolling",11)(10,"dxo-selection",12)(11,"dxo-paging",13)(12,"dxo-pager",14)(13,"dxo-search-panel",15)(14,"dxi-column",16)(15,"dxi-column",17)(16,"dxi-column",18)(17,"dxi-column",19)(18,"dxi-column",20)(19,"dxi-column",21)(20,"dxi-column",22)(21,"dxi-column",23),e.qZA()()(),e.TgZ(22,"div",7)(23,"div",24)(24,"div",9)(25,"mat-icon"),e._uU(26,"developer_board"),e.qZA(),e._uU(27," AMR Scada Meters"),e.qZA(),e.TgZ(28,"dx-data-grid",25),e.NdJ("onRowClick",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.selectScadaMeter(a))}),e._UZ(29,"dxo-scrolling",11)(30,"dxo-paging",13)(31,"dxo-selection",12)(32,"dxo-pager",14)(33,"dxo-search-panel",15)(34,"dxi-column",17)(35,"dxi-column",26)(36,"dxi-column",27),e.qZA()()(),e.TgZ(37,"div",28)(38,"div",29)(39,"div",9)(40,"mat-icon"),e._uU(41,"add_location"),e.qZA(),e._uU(42," Mapping Selection"),e.qZA(),e.TgZ(43,"div",2)(44,"mat-label",30),e._uU(45,"Register Type"),e.qZA(),e.TgZ(46,"ng-select",31)(47,"ng-option"),e._uU(48,"kWh - Total"),e.qZA(),e.TgZ(49,"ng-option"),e._uU(50,"kWh - Peak"),e.qZA(),e.TgZ(51,"ng-option"),e._uU(52,"kWh - Standard"),e.qZA(),e.TgZ(53,"ng-option"),e._uU(54,"kWh - Off-Peak"),e.qZA(),e.TgZ(55,"ng-option"),e._uU(56,"kVA"),e.qZA(),e.TgZ(57,"ng-option"),e._uU(58,"kVARh"),e.qZA()()(),e.TgZ(59,"div",2)(60,"mat-label",30),e._uU(61,"Time Of Use"),e.qZA(),e.TgZ(62,"ng-select",32)(63,"ng-option",33),e._uU(64,"Cape Town MV Restricted"),e.qZA(),e.TgZ(65,"ng-option",33),e._uU(66,"Eskom Flex Tariffs"),e.qZA(),e.TgZ(67,"ng-option",33),e._uU(68,"Non - Time Of Use"),e.qZA(),e.TgZ(69,"ng-option",33),e._uU(70,"City of Johannesburg"),e.qZA()()(),e.TgZ(71,"div",2)(72,"mat-label",30),e._uU(73,"Supply Type"),e.qZA(),e.TgZ(74,"ng-select",34)(75,"ng-option",33),e._uU(76,"AdHoc"),e.qZA(),e.TgZ(77,"ng-option",33),e._uU(78,"Electricity"),e.qZA(),e.TgZ(79,"ng-option",33),e._uU(80,"Gas"),e.qZA(),e.TgZ(81,"ng-option",33),e._uU(82,"Sewerage"),e.qZA(),e.TgZ(83,"ng-option",33),e._uU(84,"Solar"),e.qZA(),e.TgZ(85,"ng-option",33),e._uU(86,"Water"),e.qZA(),e.TgZ(87,"ng-option",33),e._uU(88,"Wind"),e.qZA()()(),e.TgZ(89,"div",2)(90,"mat-label",30),e._uU(91,"Location"),e.qZA(),e.TgZ(92,"ng-select",35)(93,"ng-option",33),e._uU(94,"Air Handling Unit"),e.qZA(),e.TgZ(95,"ng-option",33),e._uU(96,"Basement"),e.qZA(),e.TgZ(97,"ng-option",33),e._uU(98,"Borhole"),e.qZA(),e.TgZ(99,"ng-option",33),e._uU(100,"Busbar"),e.qZA(),e.TgZ(101,"ng-option",33),e._uU(102,"Chiller"),e.qZA(),e.TgZ(103,"ng-option",33),e._uU(104,"Council"),e.qZA(),e.TgZ(105,"ng-option",33),e._uU(106,"Council Check Meter"),e.qZA(),e.TgZ(107,"ng-option",33),e._uU(108,"Distribution Board"),e.qZA(),e.TgZ(109,"ng-option",33),e._uU(110,"Escalator"),e.qZA(),e.TgZ(111,"ng-option",33),e._uU(112,"Fire Hose Reel"),e.qZA(),e.TgZ(113,"ng-option",33),e._uU(114,"Fire Hydrant"),e.qZA(),e.TgZ(115,"ng-option",33),e._uU(116,"General"),e.qZA(),e.TgZ(117,"ng-option",33),e._uU(118,"Generator"),e.qZA(),e.TgZ(119,"ng-option",33),e._uU(120,"Guard House"),e.qZA(),e.TgZ(121,"ng-option",33),e._uU(122,"Irrigation"),e.qZA(),e.TgZ(123,"ng-option",33),e._uU(124,"Lift"),e.qZA(),e.TgZ(125,"ng-option",33),e._uU(126,"Lights"),e.qZA(),e.TgZ(127,"ng-option",33),e._uU(128,"Location #1"),e.qZA(),e.TgZ(129,"ng-option",33),e._uU(130,"Location for Ad Hoc"),e.qZA(),e.TgZ(131,"ng-option",33),e._uU(132,"Losses"),e.qZA(),e.TgZ(133,"ng-option",33),e._uU(134,"Management Office"),e.qZA(),e.TgZ(135,"ng-option",33),e._uU(136,"Meter"),e.qZA(),e.TgZ(137,"ng-option",33),e._uU(138,"Multiple"),e.qZA(),e.TgZ(139,"ng-option",33),e._uU(140,"Multiple shops"),e.qZA(),e.TgZ(141,"ng-option",33),e._uU(142,"Parking"),e.qZA(),e.TgZ(143,"ng-option",33),e._uU(144,"Public Toilet"),e.qZA(),e.TgZ(145,"ng-option",33),e._uU(146,"Pylon"),e.qZA(),e.TgZ(147,"ng-option",33),e._uU(148,"Refuse Area"),e.qZA(),e.TgZ(149,"ng-option",33),e._uU(150,"Shop"),e.qZA(),e.TgZ(151,"ng-option",33),e._uU(152,"Signage"),e.qZA(),e.TgZ(153,"ng-option",33),e._uU(154,"Single"),e.qZA(),e.TgZ(155,"ng-option",33),e._uU(156,"Tap"),e.qZA()()(),e.TgZ(157,"div",2)(158,"mat-form-field",36)(159,"mat-label",30),e._uU(160,"Description"),e.qZA(),e._UZ(161,"input",37),e.qZA()(),e.TgZ(162,"div",38)(163,"button",39),e._UZ(164,"mat-icon",40),e._uU(165," Add Meter Mapping "),e.qZA()()()()(),e.TgZ(166,"div",41)(167,"div",2)(168,"div",3)(169,"mat-label",42),e._uU(170," Mapped Meters "),e.qZA(),e.TgZ(171,"dx-data-grid",43),e.NdJ("onRowClick",function(a){e.CHM(t);const l=e.oxw();return e.KtG(l.selectMappedMeter(a))}),e.ALo(172,"async"),e._UZ(173,"dxo-scrolling",11)(174,"dxo-paging",13)(175,"dxo-pager",14)(176,"dxo-search-panel",15)(177,"dxi-column",17)(178,"dxi-column",18)(179,"dxi-column",19)(180,"dxi-column",44)(181,"dxi-column",45),e.qZA()()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(8),e.Q6J("dataSource",t.umfaMeters)("selectedRowKeys",e.DdM(104,N))("showBorders",!0)("hoverStateEnabled",!0),e.xp6(3),e.Q6J("pageSize",10),e.xp6(1),e.Q6J("visible",!0)("allowedPageSizes",t.allowedPageSizes)("displayMode","compact")("showPageSizeSelector",!0)("showInfo",!0)("showNavigationButtons",!0),e.xp6(1),e.Q6J("visible",!0)("width",200),e.xp6(1),e.Q6J("visible",!1),e.xp6(1),e.Q6J("width",70),e.xp6(1),e.Q6J("width",110),e.xp6(2),e.Q6J("width",70),e.xp6(1),e.Q6J("width",70),e.xp6(1),e.Q6J("width",70),e.xp6(1),e.Q6J("width",70),e.xp6(7),e.Q6J("dataSource",t.scadaMeters)("showBorders",!0)("hoverStateEnabled",!0)("selectedRowKeys",e.DdM(105,N)),e.xp6(2),e.Q6J("pageSize",10),e.xp6(2),e.Q6J("visible",!0)("allowedPageSizes",t.allowedPageSizes)("displayMode","compact")("showPageSizeSelector",!0)("showInfo",!0)("showNavigationButtons",!0),e.xp6(1),e.Q6J("visible",!0)("width",200),e.xp6(1),e.Q6J("width",70),e.xp6(1),e.Q6J("width",120),e.xp6(11),e.Q6J("formControlName","RegisterType"),e.xp6(16),e.Q6J("formControlName","TimeOfUse"),e.xp6(1),e.Q6J("value","1"),e.xp6(2),e.Q6J("value","2"),e.xp6(2),e.Q6J("value","3"),e.xp6(2),e.Q6J("value","4"),e.xp6(5),e.Q6J("formControlName","SupplyType"),e.xp6(1),e.Q6J("value","1"),e.xp6(2),e.Q6J("value","2"),e.xp6(2),e.Q6J("value","3"),e.xp6(2),e.Q6J("value","4"),e.xp6(2),e.Q6J("value","5"),e.xp6(2),e.Q6J("value","6"),e.xp6(2),e.Q6J("value","7"),e.xp6(5),e.Q6J("formControlName","Location"),e.xp6(1),e.Q6J("value","1"),e.xp6(2),e.Q6J("value","2"),e.xp6(2),e.Q6J("value","3"),e.xp6(2),e.Q6J("value","4"),e.xp6(2),e.Q6J("value","5"),e.xp6(2),e.Q6J("value","6"),e.xp6(2),e.Q6J("value","7"),e.xp6(2),e.Q6J("value","8"),e.xp6(2),e.Q6J("value","9"),e.xp6(2),e.Q6J("value","10"),e.xp6(2),e.Q6J("value","11"),e.xp6(2),e.Q6J("value","12"),e.xp6(2),e.Q6J("value","13"),e.xp6(2),e.Q6J("value","14"),e.xp6(2),e.Q6J("value","15"),e.xp6(2),e.Q6J("value","16"),e.xp6(2),e.Q6J("value","17"),e.xp6(2),e.Q6J("value","18"),e.xp6(2),e.Q6J("value","19"),e.xp6(2),e.Q6J("value","20"),e.xp6(2),e.Q6J("value","21"),e.xp6(2),e.Q6J("value","22"),e.xp6(2),e.Q6J("value","23"),e.xp6(2),e.Q6J("value","24"),e.xp6(2),e.Q6J("value","25"),e.xp6(2),e.Q6J("value","26"),e.xp6(2),e.Q6J("value","27"),e.xp6(2),e.Q6J("value","28"),e.xp6(2),e.Q6J("value","29"),e.xp6(2),e.Q6J("value","30"),e.xp6(2),e.Q6J("value","31"),e.xp6(2),e.Q6J("value","32"),e.xp6(3),e.Q6J("floatLabel","always"),e.xp6(3),e.Q6J("formControlName","Description"),e.xp6(2),e.Q6J("disabled",!t.form.valid),e.xp6(1),e.Q6J("svgIcon","feather:addMeter"),e.xp6(7),e.Q6J("dataSource",e.lcZ(172,102,t.mappedMeters$))("showBorders",!0)("hoverStateEnabled",!0),e.xp6(3),e.Q6J("pageSize",10),e.xp6(1),e.Q6J("visible",!0)("allowedPageSizes",t.allowedPageSizes)("displayMode","compact")("showPageSizeSelector",!0)("showInfo",!0)("showNavigationButtons",!0),e.xp6(1),e.Q6J("visible",!0)("width",200),e.xp6(1),e.Q6J("width",70),e.xp6(1),e.Q6J("width",120),e.xp6(2),e.Q6J("width",50),e.xp6(1),e.Q6J("width",50)}}let _e=(()=>{class o{constructor(t,r,a){this.bldService=t,this.usrService=r,this._formBuilder=a,this.umfaMeters=[],this.scadaMeters=[],this.allowedPageSizes=[10,15,20,50,"All"],this.selectedRegistryControl=new i.NI,this.selectedTOUControl=new i.NI,this.loading=!0,this._unsubscribeAll=new P.x}ngOnInit(){this.form=this._formBuilder.group({UmfaId:[null,i.kI.required],UmfaMeterId:[null,i.kI.required],ScadaMeterId:[null,i.kI.required],RegisterType:[null,i.kI.required],TimeOfUse:[null,i.kI.required],SupplyType:[null,i.kI.required],Location:[null,i.kI.required],Description:["",i.kI.required]}),this.bldService.buildings$.pipe((0,be.R)(this._unsubscribeAll)).subscribe(t=>{this.buildings=t})}selectionChanged(t){this.selectedBuildingId=t.BuildingId,this.getUmfaMetersForBuilding(this.selectedBuildingId),this.getScadaUserDetails(this.usrService.userValue.UmfaId),this.getMappedMetersForBuilding(t.BuildingId)}getUmfaMetersForBuilding(t){this.bldService.getMetersForBuilding(t).subscribe({next:r=>{this.onMetersRetrieved(r)},error:r=>this.errMessage=r,complete:()=>this.loading=!1})}onMetersRetrieved(t){this.umfaMeters=t}getScadaUserDetails(t){this.usrService.getAmrScadaUser(1).subscribe({next:r=>{this.onAmrScadaUserRetrieved(r)},error:r=>this.errMessage=r})}onAmrScadaUserRetrieved(t){var r=this;return(0,f.Z)(function*(){r.scadaUser=t,r.scadaUserName="umfagtw.gtwadmin",r.scadaPassword="gtwgtwumfa",r.getScadaMetersForUser(r.scadaUserName,r.scadaPassword)})()}getScadaMetersForUser(t,r){this.usrService.getScadaMetersForUser(t,r).subscribe(a=>{this.scadaMeters=a})}getMappedMetersForBuilding(t){this.bldService.getMappedMetersForBuilding(t).subscribe(r=>{console.log("mapped meters",r)})}selectScadaMeter(t){console.log(t),this.selectedScadaMeter=t.data,this.form.get("ScadaMeterId").setValue(this.selectedScadaMeter.Serial)}selectUmfaMeter(t){this.selectedUmfaMeter=t.data,this.form.get("UmfaMeterId").setValue(this.selectedUmfaMeter.MeterId)}selectMappedMeter(t){this.selectedMappedMeter=t.selectedRowsData[0],console.log("Mapped Meter: "+this.selectedMappedMeter)}onDelete(t){console.log("Delete",t),t.event.preventDefault()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.Fl),e.Y36(g.KD),e.Y36(i.QS))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-meter-mapping"]],decls:8,vars:7,consts:[[1,"flex","flex-col","w-full","gap-y-2",3,"formGroup"],[1,"row","grid","grid-cols-4","gap-x-4","gap-y-2","w-full"],[1,"col-span-1"],[1,"bg-card","gap-x-4","gap-y-2","p-2"],["bindLabel","Name","bindValue","BuildingId",3,"items","placeholder","formControlName","searchable","clearable","change"],[4,"ngIf"],[1,"row","grid","grid-cols-12","gap-x-4","gap-y-2","w-full"],[1,"col-span-5"],[1,"bg-card","flex","flex-col","gap-y-2"],[1,"text-lg","py-1","border-b","flex"],["id","umfaMetersGrid","keyExpr","MeterId",1,"grid-container",3,"dataSource","selectedRowKeys","showBorders","hoverStateEnabled","onRowClick"],["rowRenderingMode","virtual"],["mode","single"],[3,"pageSize"],[3,"visible","allowedPageSizes","displayMode","showPageSizeSelector","showInfo","showNavigationButtons"],["placeholder","Search...",3,"visible","width"],["dataField","MeterId","width","70",3,"visible"],["dataField","Mapped",3,"width"],["dataField","MeterNo",3,"width"],["dataField","Description"],["dataField","RegisterType",3,"width"],["dataField","MeterType",3,"width"],["dataField","Location",3,"width"],["dataField","Sequence",3,"width"],[1,"bg-card","p-2","flex","flex-col","gap-y-2"],["id","scadaMetersGrid","keyExpr","Serial",1,"grid-container",3,"dataSource","showBorders","hoverStateEnabled","selectedRowKeys","onRowClick"],["dataField","Serial",3,"width"],["dataField","Name"],[1,"col-span-2"],[1,"bg-card","gap-x-4","gap-y-2","p-2","row","grid","grid-cols-1"],[1,"form-label"],["placeholder","Select Register Type...",3,"formControlName"],["placeholder","Select Time Of Use...",3,"formControlName"],[3,"value"],["placeholder","Select Supply Type...",3,"formControlName"],["placeholder","Select Location...",3,"formControlName"],[1,"fuse-mat-dense","w-full",3,"floatLabel"],["matInput","",3,"formControlName"],[2,"align-items","center"],["mat-raised-button","","color","primary",1,"dnm-btn","dnm-btn-primary",3,"disabled"],[1,"mr-1",3,"svgIcon"],[1,"row","grid","grid-cols-1","gap-x-4","gap-y-2","w-full"],["mat-tab-nav-bar",""],["id","MappedMetersGrid","displayExpr","MeterNo","valueExpr","Id",1,"grid-container",3,"dataSource","showBorders","hoverStateEnabled","onRowClick"],["dataField","Make",3,"width"],["dataField","Model",3,"width"]],template:function(t,r){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-label"),e._uU(5," Select Building "),e.qZA(),e.TgZ(6,"ng-select",4),e.NdJ("change",function(l){return r.selectionChanged(l)}),e.qZA()()()(),e.YNc(7,Ze,182,106,"ng-container",5),e.qZA()),2&t&&(e.Q6J("formGroup",r.form),e.xp6(6),e.Q6J("items",r.buildings)("placeholder","Select Building")("formControlName","UmfaId")("searchable",!0)("clearable",!1),e.xp6(1),e.Q6J("ngIf",r.selectedBuildingId>0))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,m.O5,i.sg,i.u,v.lW,Z.Hw,A.BU,h.KE,h.hX,M.Nt,y.w9,y.jq,C.e,c.qvW,c.ilc,c.sXh,c.PXJ,c.XXE,c.Lz9,m.Ov],styles:["button[_ngcontent-%COMP%]{min-width:120px}"]}),o})();var Me=s(21860);const we=[{path:"",component:O,resolve:{data:xe.i},children:[{path:"",redirectTo:"amrUser",pathMatch:"full"},{path:"amrUser",component:D},{path:"amrUser/:id",component:B},{path:"amrMeter",component:Y},{path:"amrUser/edit/:opId/:asuId",component:ce},{path:"amrMeter/:id",component:fe},{path:"amrMeter/edit/:opId/:meterId",component:ve},{path:"meterMapping",component:_e,resolve:{data:(()=>{class o{constructor(t,r){this._service=t,this._usrService=r}resolve(t,r){return(0,Me.T)(this._service.getBuildingsForUser(this._usrService.userValue.UmfaId))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(g.Fl),e.LFG(g.KD))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}]}];let Ae=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.ez,d.Bz.forChild(we),d.Bz]}),o})();var Ce=s(74350),ye=s(37767),Te=s(20039),Se=s(50317);let qe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[i.u5,m.ez,Ae,Ce.O,i.UX,q.ZX,v.ot,Z.Ps,A.Nh,Se.p0,h.lN,M.c,y.A0,C.x,Te.e,ye.m,d.Bz,q.ZX,v.ot,Z.Ps]}),o})()}}]);